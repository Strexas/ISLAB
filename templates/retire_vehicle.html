{% extends "car_details.html" %}

{% block title %}Retire Vehicle{% endblock %}

{% block content %}

<h1 style="margin-bottom: 20px;">
    Retire Vehicle: {{ vehicle.manufacturer }} {{ vehicle.model }}
</h1>

<div class="card" style="padding: 30px;">
    
    <!-- Warning Box -->
    <div class="warning_box">
        <h3>⚠️ Warning</h3>
        <p>You are about to retire this vehicle. This action will:</p>
        <ul>
            <li>Set the vehicle status to <strong>Inactive</strong></li>
            <li>Hide the vehicle from customer fleet listings</li>
            <li>Prevent any new bookings</li>
        </ul>
        <p><strong>This action cannot be easily undone.</strong></p>
    </div>

    <!-- Vehicle Details -->
    <div class="info_box">
        <h4>Vehicle Details</h4>
        <p><strong>ID:</strong> {{ vehicle.vehicle_id }}</p>
        <p><strong>Plate:</strong> {{ vehicle.license_plate }}</p>
        <p><strong>Status:</strong> {{ vehicle.status }}</p>
        <p><strong>Added:</strong> 
            {{ vehicle.created_at.strftime('%Y-%m-%d') if vehicle.created_at else 'Unknown' }}
        </p>
    </div>

    <!-- Form -->
    <form method="POST" action="{{ url_for('fleet.retire_vehicle', vehicle_id=vehicle.vehicle_id) }}">
        {{ form.hidden_tag() }}

        <!-- Reason -->
        <div class="form-group">
            {{ form.reason.label }}
            {{ form.reason(class="form_input", rows=3,
                placeholder="Reason for retirement (e.g., end of service, mechanical failure, accident, etc.)"
            ) }}
            {% for error in form.reason.errors %}
            <p class="form_error">{{ error }}</p>
            {% endfor %}
        </div>

        <!-- Confirmation Checkbox -->
        <div class="form-group" style="margin-top: 20px;">
            <label class="checkbox_row">
                {{ form.confirm() }}
                <span>I confirm that I want to retire this vehicle.</span>
            </label>
            {% for error in form.confirm.errors %}
            <p class="form_error">{{ error }}</p>
            {% endfor %}
        </div>

        <!-- Buttons -->
        <div class="form-actions">
            <button type="submit" 
                    class="danger_button"
                    onclick="return confirm('Are you sure you want to retire this vehicle?');">
                Confirm Retirement
            </button>

            <a class="secondary_button"
               href="{{ url_for('fleet.vehicle_details', vehicle_id=vehicle.vehicle_id) }}">
                Cancel
            </a>
        </div>
    </form>
</div>

{% endblock %}
